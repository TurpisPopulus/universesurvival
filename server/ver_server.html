<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Kilo UDP Server - Версия</title>
    <style>
      :root {
        color-scheme: light;
        --ink: #1e1c18;
        --muted: #5a524a;
        --bg: #f4efe6;
        --accent: #1f6f5f;
        --accent-soft: #cde7df;
        --warm: #f3c37a;
        --panel: #ffffff;
        --stroke: rgba(30, 28, 24, 0.12);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Segoe UI", "Tahoma", sans-serif;
        background:
          radial-gradient(circle at 15% 15%, #fff9ef 0%, transparent 55%),
          radial-gradient(circle at 85% 10%, #e2f3ee 0%, transparent 52%),
          var(--bg);
        color: var(--ink);
      }

      .page {
        max-width: 980px;
        margin: 0 auto;
        padding: 36px 20px 60px;
        position: relative;
      }

      header {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }

      .brand {
        font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
        font-size: 28px;
        font-weight: 700;
        letter-spacing: 0.5px;
      }

      .tag {
        background: var(--accent-soft);
        color: var(--accent);
        padding: 6px 14px;
        border-radius: 999px;
        font-size: 13px;
        font-weight: 600;
      }

      .hero {
        margin-top: 28px;
        padding: 26px;
        border-radius: 24px;
        background: var(--panel);
        border: 1px solid var(--stroke);
        box-shadow: 0 20px 60px rgba(30, 28, 24, 0.12);
      }

      h1 {
        font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
        font-size: clamp(32px, 4vw, 44px);
        margin: 0 0 10px;
      }

      p {
        line-height: 1.6;
        color: var(--muted);
      }

      .card {
        background: var(--panel);
        border-radius: 18px;
        padding: 18px;
        border: 1px solid var(--stroke);
        margin-top: 18px;
      }

      ul {
        margin: 10px 0 0 18px;
        color: var(--muted);
      }

      footer {
        margin-top: 40px;
        font-size: 14px;
        color: var(--muted);
      }

      @media (max-width: 640px) {
        header {
          flex-direction: column;
          align-items: flex-start;
        }
      }
    </style>
  </head>
  <body>
    <div class="page">
      <header>
        <div class="brand">Kilo UDP Server</div>
        <div class="tag">Версия</div>
      </header>

      <section class="hero">
        <h1>История версий</h1>
        <p>Формат: v0.000 / дата / список изменений.</p>
        <div class="card">
          <strong>v0.032 / 2026-01-09</strong>
          <ul>
            <li>UDP receive игнорирует <code>SocketError.ConnectionReset</code> (ICMP port unreachable от клиентов).</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.031 / 2026-01-09</strong>
          <ul>
            <li>LOGIN теперь помечает игрока как <code>id="login"</code> до первого позиционного пакета и не включает его в рассылку.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.030 / 2026-01-09</strong>
          <ul>
            <li>docs_server дополнен правилами готовности клиента и окна активности.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.029 / 2026-01-09</strong>
          <ul>
            <li>Увеличен тик рассылки позиций до 30 Гц (33 мс).</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.028 / 2026-01-09</strong>
          <ul>
            <li>Добавлена периодическая рассылка позиций с фиксированным тиком (20 Гц).</li>
            <li>Широковещательные обновления больше не зависят от входящих пакетов.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.027 / 2026-01-09</strong>
          <ul>
            <li>Добавлен троттлинг логов позиционных обновлений (1 раз/сек на игрока).</li>
            <li>Логи координат форматируются через точку для читабельности.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.026 / 2026-01-09</strong>
          <ul>
            <li>REGISTER поддерживает сохранение внешности (base64 JSON) в аккаунте.</li>
            <li>LOGIN и рассылка игроков возвращают appearance вместе с координатами.</li>
            <li>Протокол обновлен: id|name|x|y|appearance.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.025 / 2026-01-09</strong>
          <ul>
            <li>OBJECT_EDIT поддерживает удаление объектов через typeId "__remove__".</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.024 / 2026-01-09</strong>
          <ul>
            <li>docs_server уточнен по object_types.json и isBlocking в OBJECT_EDIT.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.023 / 2026-01-09</strong>
          <ul>
            <li>Добавлены типы объектов из tiles/objects.png (barrel, crate, planks, tree, rock, house).</li>
            <li>Характеристики объектов обновлены в object_types.json.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.022 / 2026-01-09</strong>
          <ul>
            <li>Типы объектов перенесены в object_types.json вместо кода.</li>
            <li>OBJECT_EDIT использует характеристики объектов из JSON.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.021 / 2026-01-09</strong>
          <ul>
            <li>Добавлен слой объектов: OBJECTS/OBJECT_EDIT и хранение objects_*.json по чанкам.</li>
            <li>Объекты сохраняются отдельно от terrain и обновляют версии чанков объектов.</li>
            <li>docs_server дополнен подробным описанием объектов, форматов и протокола.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.020 / 2026-01-09</strong>
          <ul>
            <li>Документация сервера дополнена подробным описанием команды EDIT и клиентского потока сохранения карты.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.019 / 2026-01-09</strong>
          <ul>
            <li>Документация сервера переписана как структурный план масштабируемой архитектуры.</li>
            <li>Зафиксирован принцип RAM-first: JSON только для хранения и снимков.</li>
            <li>Добавлены структуры ресурсов, объектов и NPC на уровне контрактов.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.018 / 2026-01-09</strong>
          <ul>
            <li>Карта хранится в RAM как чанки 100x100 с версией и флагом изменений.</li>
            <li>Добавлена загрузка chunk_*.json и периодическое сохранение только грязных чанков.</li>
            <li>Протокол карты переведен на CHUNK|cx|cy|lastVersion и EDIT.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.017 / 2026-01-09</strong>
          <ul>
            <li>Добавлены лог-сообщения обработки изменений карты с количеством и путём сохранения.</li>
            <li>Добавлена защита от поврежденных данных карты.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.016 / 2026-01-09</strong>
          <ul>
            <li>Данные сервера сохраняются в Data/ рядом с исполняемым файлом, независимо от CWD.</li>
            <li>Убрана перезагрузка карты после сохранения изменений.</li>
            <li>Сохранение JSON выполняется атомарно через временный файл.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.015 / 2026-01-08</strong>
          <ul>
            <li>Карта перечитывается из резервной копии для синхронизации RAM.</li>
            <li>Чтение чанков защищено блокировкой на время обновления карты.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.014 / 2026-01-08</strong>
          <ul>
            <li>Уточнено логирование чанков и образца изменений для диагностики.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.013 / 2026-01-08</strong>
          <ul>
            <li>Добавлено логирование пути файлов карты и чанков с последним изменением.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.012 / 2026-01-08</strong>
          <ul>
            <li>Добавлена диагностика координат изменений карты при отклонении.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.011 / 2026-01-08</strong>
          <ul>
            <li>Добавлено логирование приема и применения изменений карты.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.010 / 2026-01-08</strong>
          <ul>
            <li>Добавлен прием изменений карты и сохранение.</li>
            <li>Добавлена обработка изменений карты на сервере.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.009 / 2026-01-08</strong>
          <ul>
            <li>Добавлен уровень доступа для аккаунтов и выдача при входе.</li>
            <li>Админ получает уровень 1, остальные по умолчанию 5.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.008 / 2026-01-08</strong>
          <ul>
            <li>Исправлен конфликт имен переменных response при сборке.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.007 / 2026-01-08</strong>
          <ul>
            <li>Добавлена загрузка карты из резервных файлов в RAM.</li>
            <li>Реализован ответ на запросы чанков.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.006 / 2026-01-08</strong>
          <ul>
            <li>Убрано предупреждение SYSLIB0060 для PBKDF2.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.005 / 2026-01-08</strong>
          <ul>
            <li>Добавлено сохранение аккаунтов и игроков при завершении сервера.</li>
            <li>LOGIN возвращает сохраненные координаты игрока.</li>
            <li>Пароли хранятся как хэш с солью (PBKDF2).</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.004 / 2026-01-08</strong>
          <ul>
            <li>Добавлена регистрация и вход с паролем через REGISTER/LOGIN.</li>
            <li>Сервер сохраняет аккаунты в accounts.json.</li>
            <li>Добавлен ответ на PING для проверки доступности.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.003 / 2026-01-08</strong>
          <ul>
            <li>Добавлена проверка имени онлайн через LOGIN.</li>
            <li>Запрещен одновременный вход под одним именем.</li>
            <li>Успешный LOGIN резервирует имя на время активности.</li>
          </ul>
        </div>
        <div class="card">
          <strong>v0.002 / 2026-01-08</strong>
          <ul>
            <li>Сервер рассылает список игроков всем клиентам.</li>
            <li>Добавлено сохранение в players.json с периодическим авто-сейвом.</li>
          </ul>
        </div>
      </section>

      <footer>
        <p>Файл версий. Обновляй при изменениях сервера.</p>
      </footer>
    </div>
  </body>
</html>
